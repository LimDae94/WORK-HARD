# 중앙처리장치

<br>

> 컴퓨터의 구성 요소인 중앙처리장치에 대해 이해한다.

<br>

## 1. 학습 목표

최상위 레벨에서 본 컴퓨터의 구성 요소의 역할 및 기능은 **중앙처리장치(CPU)** , **주기억장치(main memory)** , **입출력장치(I/O devices)**  입니다. 이번 장에서는 **중앙처리장치**에 대해서 설명을 하도록 하겠습니다.

<br>

## 2. 중앙처리장치 살펴보기

<br>

<img src="https://velog.velcdn.com/images/piay801/post/a48d22bc-ec97-443a-b552-8f081206a9dc/image.png" alt="image-20220727005636972" style="zoom:60%;" />

<br>

### 중앙처리장치의 주요 기능

<br>

> 프로그램을 실행하며 컴퓨터의 모든 동작을 제어한다.

<br>

중앙처리장치(CPU, Central Processing Unit)는 **프로그램을 실행하며 컴퓨터의 모든 동작을 제어** 하는 역할을 수행합니다. 항상 사람과 컴퓨터를 비유할 때 많이 등장하는 말로는 사람의 두뇌에 해당한다고 많이들 보셨을 겁니다. 우리 신체는 생각과 행동은 두뇌에서부터 시작하는 것처럼, 컴퓨터의 모든 데이터 처리는 중앙처리장치로부터 시작하기 때문이에요.

우리가 자주 사용하는 프로그램인 슬랙, 인텔리제이, 크롬, 카카오톡 등 다양한 프로그램을 실행할 때, 중앙처리장치가 프로그램을 실행한다는 것을 알았습니다. 우리는 평소에 GUI(Graphical User Interface) 환경에서 실행할 프로그램의 아이콘을 [`더블 클릭`] 혹은 [`바로 가기`]를 통해서 어떠한 의심 없이 실행해왔습니다. **지금부터 프로그램 실행이 컴퓨터 안에서는 어떻게 수행이 되며 중앙처리장치와 어떠한 관계를 가지는지에 대해서 알아보겠습니다.**



<br>

### 프로그램 실행[전체적인 관점]

<br>

`Chrome` 을 통해서 프로그램 실행을 알아보겠습니다! 

1. [`바탕화면`] 혹은 [`메뉴 하단 바의 아이콘`] 을 **클릭**합니다.

<img src="https://velog.velcdn.com/images/piay801/post/59eaba1e-6565-4967-b5e4-540d82ffda10/image.png" alt="image-20220727013708448" style="zoom:80%;" />

<br>



2. 컴퓨터(`운영체제`)는 바로가기가 가리키는 실제로 존재하는 프로그램의 폴더로 이동하고, **Chrome 실행파일**을 실행합니다.

<img src="https://velog.velcdn.com/images/piay801/post/c1d8ccca-1127-4ae7-8132-7fea0a40bcd8/image.jpg" alt="2" style="zoom:67%;" />



<br>



3. 운영체제(`Windows 11`)가 로컬 디스크(`SSD`)에 있는 프로그램인 `Chrome`을 실행해서 `Chrome` 프로그램 코드들을 메모리에 적재(**프로세스 생성**)하게 되는데, **사용자 메모리 공간**에 배치합니다.

   그 이후로 `Chrome` 프로세스를 제어할 때 필요한 모든 정보들을 모은 PCB(Process Control Block)을 생성하고 **커널 메모리 공간**으로 배치하게 됩니다.

<img src="https://velog.velcdn.com/images/piay801/post/016a3493-0c9b-47ca-a960-0f9df4946b9a/image.jpg" alt="3" style="zoom:80%;" />



<br>



4. 사용자가 가장 최근에 실행한 **Chrome 프로세스의 `PCB`** 는 **높은 우선순위** 가 주어지게 되고, 운영체제의 **프로세스 스케줄러**는 PCB에 적힌 우선순위에 따라서 **준비 큐**에 배치합니다.

   <img src="https://velog.velcdn.com/images/piay801/post/8242d91e-3a1d-47b7-8f24-f4bdf39cc327/image.png" alt="image-20220727022736101" style="zoom:67%;" />

<img src="https://velog.velcdn.com/images/piay801/post/e2fd14c0-b47f-40a4-a4df-591508d57aa1/image.png" alt="image-20220727025616677" style="zoom:60%;" />



<br>



5. 기존에 실행중인 프로세스의 **시간 할당량** 이 끝나면 바로 **프로세서(CPU)** 를 **Chrome 프로세스** 에게 전달해서 실행합니다.

<img src="https://velog.velcdn.com/images/piay801/post/3437851d-afbf-4d20-9949-f39119c10a38/image.png" alt="image-20220727030350892" style="zoom:67%;" />



<br>



6. 프로세서(CPU)에게 할당을 받은 후, `Chrome`이 실행이 됩니다.

<img src="https://velog.velcdn.com/images/piay801/post/d1d4ebd0-3ec0-4dda-baa1-f519d4e688d4/image.png" alt="image-20220727030430655" style="zoom:67%;" />



<br>

**프로그램 실행의 [전체적인 관점]** 의 과정을 `Chrome`으로 살펴봤습니다. 각 과정들을 세분화해서 간단하게 보면 다음과 같습니다.

<br>

- 운영체제의 이해
- 컴퓨터 하드웨어의 구성
- 운여체제의 처리시스템
- C언어 지식
- 프로세스의 메모리 구조(스택, 힙, 데이터, 코드)
- 프로세스 관리
- PCB(Process Control Block)의 구조
- 스케줄링 알고리즘
- 스케줄링
- CPU 동작 구성
- CPU의 이해
- 네트워크 

<br>

우리가 전체적인 관점에서 프로그램의 실행을 바라보게 될 때, 위의 지식들보다 더 많은 지식이 필요합니다. 그렇다면, 프로그램 실행을 이렇게까지 설명한 이유는 무엇일까요? **어떠한 관점에서 바라보느냐에 따라서 설명은 달라질 수 있는 것입니다.** 앞으로 학습하게 될 **컴퓨터 구조적인 관점에서 바라보는 프로그램 실행에 대해서 이해하는 것을 목표**로, 전체적인 관점에서 프로그램의 실행을 이해한다고 엄격하게 말할 수는 없습니다. 결론은 기술 면접 때, 적절한 답변을 이끌 수 있도록 폭넓게 학습할 필요가 있다고 느낄 수 있을 것입니다.🐝

<br>

## 3. 중앙처리장치 구성 요소(간단)

<br>

### 중앙처리장치

➡️ 제어장치, 연산장치, 레지스터로 구성

➡️ CPU 내부 버스로 서로 연결

<br>

![](https://velog.velcdn.com/images/piay801/post/2475b22e-f920-4696-af9c-c2192dba607c/image.jpg)

<br>

### 연산장치

산술연산과 논리연산 수행 (따라서 산술논리연산장치라고도 불림)

연산에 필요한 데이터를 레지스터에서 가져오고, 연산 결과를 다시 레지스터로 보냄



### 제어장치

- 명령어를 순서대로 실행할 수 있도록 제어하는 장치

  주기억장치에서 프로그램 명령어를 꺼내 해독하고, 그 결과에 따라 명령어 실행에 필요한 제어 신호를 기억장치, 연산장치, 입출력장치로 보냄

  또한 이들 장치가 보낸 신호를 받아, 다음에 수행할 동작을 결정함



### 레지스터

고속 기억장치임

명령어 주소, 코드, 연산에 필요한 데이터, 연산 결과 등을 임시로 저장

용도에 따라 범용 레지스터와 특수목적 레지스터로 구분됨

중앙처리장치 종류에 따라 사용할 수 있는 레지스터 개수와 크기가 다름

- 범용 레지스터 : 연산에 필요한 데이터나 연산 결과를 임시로 저장
- 특수목적 레지스터 : 특별한 용도로 사용하는 레지스터



### 특수 목적 레지스터 중 중요한 것들

- MAR(메모리 주소 레지스터) : 읽기와 쓰기 연산을 수행할 주기억장치 주소 저장
- PC(프로그램 카운터) : 다음에 수행할 명령어 주소 저장
- IR(명령어 레지스터) : 현재 실행 중인 명령어 저장
- MBR(메모리 버퍼 레지스터) : 주기억장치에서 읽어온 데이터 or 저장할 데이터 임시 저장
- AC(누산기) : 연산 결과 임시 저장



### CPU의 동작 과정

1. 주기억장치는 입력장치에서 입력받은 데이터 또는 보조기억장치에 저장된 프로그램 읽어옴
2. CPU는 프로그램을 실행하기 위해 주기억장치에 저장된 프로그램 명령어와 데이터를 읽어와 처리하고 결과를 다시 주기억장치에 저장
3. 주기억장치는 처리 결과를 보조기억장치에 저장하거나 출력장치로 보냄
4. 제어장치는 1~3 과정에서 명령어가 순서대로 실행되도록 각 장치를 제어



### 명령어 세트

CPU가 실행할 명령어의 집합

> 연산 코드(Operation Code) + 피연산자(Operand)로 이루어짐
>
> 연산 코드 : 실행할 연산
>
> 피연산자 : 필요한 데이터 or 저장 위치

연산 코드는 연산, 제어, 데이터 전달, 입출력 기능을 가짐

피연산자는 주소, 숫자/문자, 논리 데이터 등을 저장

CPU는 프로그램 실행하기 위해 주기억장치에서 명령어를 순차적으로 인출하여 해독하고 실행하는 과정을 반복함

CPU가 주기억장치에서 한번에 하나의 명령어를 인출하여 실행하는데 필요한 일련의 활동을 '명령어 사이클'이라고 말함

명령어 사이클은 인출/실행/간접/인터럽트 사이클로 나누어짐

주기억장치의 지정된 주소에서 하나의 명령어를 가져오고, 실행 사이클에서는 명령어를 실행함. 하나의 명령어 실행이 완료되면 그 다음 명령어에 대한 인출 사이클 시작





### 인출 사이클과 실행 사이클에 의한 명령어 처리 과정

> 인출 사이클에서 가장 중요한 부분은 PC(프로그램 카운터) 값 증가

- PC에 저장된 주소를 MAR로 전달
- 저장된 내용을 토대로 주기억장치의 해당 주소에서 명령어 인출
- 인출한 명령어를 MBR에 저장
- 다음 명령어를 인출하기 위해 PC 값 증가시킴
- 메모리 버퍼 레지스터(MBR)에 저장된 내용을 명령어 레지스터(IR)에 전달

```text
T0 : MAR ← PC
T1 : MBR ← M[MAR], PC ← PC+1
T2 : IR ← MBR
```

여기까지는 인출하기까지의 과정



### 인출한 이후, 명령어를 실행하는 과정

> ADD addr 명령어 연산

```text
T0 : MAR ← IR(Addr)
T1 : MBR ← M[MAR]
T2 : AC ← AC + MBR
```

이미 인출이 진행되고 명령어만 실행하면 되기 때문에 PC를 증가할 필요x

IR에 MBR의 값이 이미 저장된 상태를 의미함

따라서 AC에 MBR을 더해주기만 하면 됨
